# 节点管理界面 - 快速参考卡片

## 🚀 快速开始

### 打开节点管理界面

```
路由: /low_admin/ss_node
菜单: 低权限管理后台 → 节点管理 (Icons.cloud)
```

### 支持的操作

| 操作   | 快捷方式         | API 端点                 |
|------|--------------|------------------------|
| 查看列表 | 打开页面         | `GET /ss_node/`        |
| 搜索   | 输入 + 回车或点击搜索 | `GET /ss_node/?q=...`  |
| 新增   | 点击"新增节点"     | `POST /ss_node/`       |
| 编辑   | 点击"编辑"按钮     | `PUT /ss_node/{id}`    |
| 删除   | 点击"删除"按钮     | `DELETE /ss_node/{id}` |

---

## 🌍 国家代码显示位置

### 桌面视图 (≥ 1100px)

```
表格列: ID | 名称 | 主机 | 端口 | 协议 | 【国家代码】| 优先级 | ...
            ↑ 在协议列之后
示例: 【HK】、【CN】、【SG】
```

### 平板/手机视图 (< 1100px)

```
卡片信息:
主机: ...
端口: ...
协议: ...
【国家代码: HK】 ← 这一行
倍率: ...
```

---

## 📝 表单必填字段

```
✓ 节点名称        (例: "HK Node 1")
✓ 主机地址        (例: "123.45.67.89")
✓ 优先级          (默认: 60000)
✓ 节点等级        (默认: 0)
✓ 倍率            (默认: 1.0)
✓ 协议类型        (例: vmess)
✓ 【国家代码】    (必须选择，如: HK、CN、SG)
✓ 启用状态        (默认: 启用)
✓ 隐藏状态        (默认: 否)
```

---

## 🔧 常见 ISO 3166-1 国家代码

| 代码 | 国家/地区 | 代码 | 国家/地区 |
|----|-------|----|-------|
| CN | 中国    | US | 美国    |
| HK | 香港    | GB | 英国    |
| SG | 新加坡   | DE | 德国    |
| JP | 日本    | FR | 法国    |
| KR | 韩国    | CA | 加拿大   |
| TW | 台湾    | AU | 澳大利亚  |
| TH | 泰国    | IN | 印度    |
| MY | 马来西亚  | BR | 巴西    |

---

## 🛠️ API 调用示例

### 创建节点 (含国家代码)

```dart
final node = SsNodeInput(
  nodeName: 'SG-Node',
  nodeConfig: NodeConfig(host: 'sg.example.com', port: 443),
  iso3166Code: CountryCode.sg,  // 国家代码
  vpnType: VpnTypeEnum.vmess,
  // ... 其他必填字段
);

await client.fallback.postSsNodeApiV2LowAdminApiSsNodePost(body: node);
```

### 获取节点列表

```dart
final response = await client.fallback
    .getSsNodeListApiV2LowAdminApiSsNodeGet(
      q: 'HK',      // 模糊搜索
      offset: 0,    // 分页
      limit: 100,
    );
```

### 显示国家代码

```dart
final countryCode = node.iso3166Code.name.toUpperCase();
print('国家代码: $countryCode');  // 输出: 国家代码: HK
```

---

## 📱 响应式断点

```
手机        平板           桌面
< 640px    640px-1100px   ≥ 1100px
  ↓          ↓              ↓
单列卡片    2列网格        DataTable
抽屉菜单    侧边栏导航     侧边栏导航
```

---

## ⚡ 快速操作流程

### 添加新节点

```
1. 点击"新增节点"
2. 输入节点名称
3. 输入主机地址
4. 【选择国家代码】← 必须步骤
5. 点击"保存"
✓ 完成
```

### 修改国家代码

```
1. 找到目标节点
2. 点击"编辑"
3. 修改"国家/地区代码"下拉菜单
4. 点击"保存"
✓ 更新完成，国家代码在列表中即时显示
```

### 删除节点

```
1. 点击"删除"
2. 在对话框确认
✓ 删除完成
```

---

## 🔐 认证信息

- **认证方式**: Bearer Token
- **自动实现**: 是（通过 `createAuthenticatedClient()`）
- **Token 过期**: 自动跳转登录页

---

## ⏱️ 时间显示

- **存储**: UTC 时间
- **显示**: 本地时间 + 时区转换
- **格式**: `yyyy-MM-dd HH:mm:ss`

例: `2025-11-22 14:30:45`

---

## 📊 屏幕适配示例

### 手机 (375px)

```
┌─────────────────┐
│ 节点名称 [状态] │
├─────────────────┤
│ ID: 123         │
│ 主机: 1.2.3.4   │
│ 端口: 443       │
│ 协议: vmess     │
│ 【国家代码: HK】│
│ 倍率: 1.00      │
│ 等级: 0         │
│ 隐藏: 否        │
│ 时间: ...       │
│ [编辑] [删除]   │
└─────────────────┘
```

### 平板 (800px)

```
┌──────────────────┐ ┌──────────────────┐
│ 节点卡片 1       │ │ 节点卡片 2       │
│ 国家代码: HK     │ │ 国家代码: SG     │
│ [编辑] [删除]    │ │ [编辑] [删除]    │
└──────────────────┘ └──────────────────┘
```

### 桌面 (1400px)

```
ID | 名称 | 主机 | 端口 | 协议 | 【国家代码】| 优先级 | ... | 操作
1  | node | 1.2  | 443  | vmess| 【HK】     | 60000 | ... | ✏️ 🗑️
2  | node | ...  | ...  | ...  | 【SG】     | ...   | ... | ✏️ 🗑️
```

---

## 🎨 颜色代码

| 状态 | 显示   | 颜色                  |
|----|------|---------------------|
| 启用 | Chip | 绿色 (enable state)   |
| 禁用 | Chip | 红色 (disabled state) |

---

## 🐛 常见问题

**Q: 如何搜索节点？**
A: 在搜索框输入节点名称、备注或 ID，按 Enter 或点击搜索按钮

**Q: 国家代码在哪里修改？**
A: 点击编辑后，在表单中找到"国家/地区代码"下拉菜单选择

**Q: 如何刷新列表？**
A: 下拉刷新或点击"刷新"按钮

**Q: 能否批量删除？**
A: 不能，需要逐个删除

**Q: 新增时哪些字段是必填的？**
A: 所有标记为"必填"的字段，包括国家代码

---

## 📖 完整文档

| 文档                   | 用途          |
|----------------------|-------------|
| `22_节点管理界面.md`       | 功能说明、使用方法   |
| `22_节点管理界面_测试指南.md`  | 详细的测试步骤     |
| `22_节点管理界面_API文档.md` | API 细节、代码示例 |

---

**版本**: 1.0  
**更新**: 2025-11-22  
**状态**: ✅ 完成

